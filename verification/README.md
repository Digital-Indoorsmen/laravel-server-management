# Server Setup Verification Suite

This suite automatically verifies that the `setup.sh` script correctly provisions a server.

## Prerequisites

1.  **Vagrant & VirtualBox**: To provision test VMs.
2.  **Python 3.8+**: To run the test suite.

## Setup

1.  **Start the VMs**:
    ```bash
    cd verification
    vagrant up
    ```

2.  **Run the Setup Script**:
    On each VM (almalinux9, rocky9), run the setup script generated by your panel.
    ```bash
    # Connect to the VM
    vagrant ssh almalinux9
    
    # Run the setup script (get the URL from your dashboard)
    curl -sSL http://YOUR_PANEL_IP/setup/YOUR_TOKEN | sudo bash
    ```

3.  **Install Python Dependencies**:
    ```bash
    pip install -r requirements.txt
    ```

4.  **Run Tests**:
    ```bash
    pytest tests/test_server_state.py
    ```

## Tests Performed

- OS Detection validation.
- Installation of Nginx, MariaDB, PostgreSQL, Redis, and Fail2ban.
- Service health checks for all components including multi-PHP versions.
- User management and directory structure verification.
- SELinux status and Firewalld rules verification.
- Idempotency check (via log analysis).
